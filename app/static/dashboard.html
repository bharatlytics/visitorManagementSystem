<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visitor Management System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <link href="/css/apps/vms.css" rel="stylesheet">
</head>

<body>
    <div class="d-flex" id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <div class="sidebar-heading">
                <div class="d-flex align-items-center w-100 justify-content-center">
                    <img src="" alt="Logo" id="sidebar-logo" class="company-logo d-none me-2">
                    <span class="fs-5 fw-bold text-dark" id="sidebar-title">VMS</span>
                </div>
            </div>
            <div class="list-group list-group-flush my-3">
                <a href="#" class="list-group-item list-group-item-action active" id="nav-dashboard">
                    <i class="fas fa-tachometer-alt me-3"></i>Dashboard
                </a>
                <a href="#" class="list-group-item list-group-item-action" id="nav-visitors">
                    <i class="fas fa-users me-3"></i>Visitors
                </a>
                <a href="#" class="list-group-item list-group-item-action" id="nav-visits">
                    <i class="fas fa-calendar-check me-3"></i>Visits
                </a>
                <a href="#" class="list-group-item list-group-item-action" id="nav-settings">
                    <i class="fas fa-cog me-3"></i>Settings
                </a>
                <a href="#" class="list-group-item list-group-item-action" id="nav-security">
                    <i class="fas fa-shield-alt me-3"></i>Security
                </a>
                <a href="#" class="list-group-item list-group-item-action" id="nav-reports">
                    <i class="fas fa-chart-bar me-3"></i>Reports
                </a>
                <div class="mt-auto border-top">
                    <a href="#" class="list-group-item list-group-item-action text-danger" id="nav-exit">
                        <i class="fas fa-sign-out-alt me-3"></i>Exit App
                    </a>
                </div>
            </div>
        </div>

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <nav class="navbar navbar-expand-lg navbar-light">
                <div class="container-fluid">
                    <div class="d-flex align-items-center">
                        <button class="btn btn-link text-dark p-0 me-3" id="menu-toggle">
                            <i class="fas fa-bars fs-5"></i>
                        </button>
                        <h5 class="m-0 fw-bold" id="page-title">Dashboard</h5>
                    </div>
                    <div class="navbar-nav ms-auto">
                        <span class="nav-item" id="mode-indicator"></span>
                    </div>
                </div>
            </nav>

            <div class="container-fluid px-4 py-4" id="main-content">
                <!-- Dashboard View -->
                <div id="view-dashboard">
                    <!-- Stats Cards -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card text-white shadow-sm h-100 cursor-pointer"
                                style="background: linear-gradient(135deg, #5a67d8 0%, #4c51bf 100%); cursor: pointer;"
                                data-bs-toggle="modal" data-bs-target="#currentVisitorsModal">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="card-title mb-0 text-white fw-light">Current Visitors</h6>
                                            <h2 class="display-6 fw-bold mb-0 text-white" id="stat-current-visitors">0
                                            </h2>
                                        </div>
                                        <i class="fas fa-users fa-2x opacity-50"></i>
                                    </div>
                                    <small class="text-white opacity-75">Currently inside</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-white shadow-sm h-100"
                                style="background: linear-gradient(135deg, #38b2ac 0%, #319795 100%); cursor: pointer;"
                                data-bs-toggle="modal" data-bs-target="#expectedTodayModal">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="card-title mb-0 text-white fw-light">Expected Today</h6>
                                            <h2 class="display-6 fw-bold mb-0 text-white" id="stat-expected-today">0
                                            </h2>
                                        </div>
                                        <i class="fas fa-calendar-day fa-2x opacity-50"></i>
                                    </div>
                                    <small class="text-white opacity-75">Scheduled</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-white shadow-sm h-100"
                                style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); cursor: pointer;"
                                data-bs-toggle="modal" data-bs-target="#checkedInModal">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="card-title mb-0 text-white fw-light">Checked In Today</h6>
                                            <h2 class="display-6 fw-bold mb-0 text-white" id="stat-checked-in">0</h2>
                                        </div>
                                        <i class="fas fa-sign-in-alt fa-2x opacity-50"></i>
                                    </div>
                                    <small class="text-white opacity-75">Total arrivals</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-white shadow-sm h-100"
                                style="background: linear-gradient(135deg, #718096 0%, #4a5568 100%); cursor: pointer;"
                                data-bs-toggle="modal" data-bs-target="#checkedOutModal">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="card-title mb-0 text-white fw-light">Checked Out Today</h6>
                                            <h2 class="display-6 fw-bold mb-0 text-white" id="stat-checked-out">0</h2>
                                        </div>
                                        <i class="fas fa-sign-out-alt fa-2x opacity-50"></i>
                                    </div>
                                    <small class="text-white opacity-75">Total departures</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-8">
                            <div class="card shadow-sm mb-4">
                                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0 fw-bold text-dark">Recent Activity</h5>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="Dashboard.loadStats()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                                <div class="card-body p-0">
                                    <div class="table-responsive">
                                        <table class="table table-hover align-middle mb-0" id="activity-table">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>Visitor</th>
                                                    <th>Action</th>
                                                    <th>Time</th>
                                                    <th>Host</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td colspan="4" class="text-center py-4 text-muted">Loading...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="card shadow-sm mb-3">
                                <div class="card-header bg-white border-bottom">
                                    <h6 class="mb-0 fw-bold text-dark">Quick Actions</h6>
                                </div>
                                <div class="card-body p-3">
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-sm btn-primary"
                                            onclick="switchView('visits'); setTimeout(() => $('#btn-schedule-visit').click(), 100);">
                                            <i class="fas fa-calendar-plus me-1"></i> Schedule Visit
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary"
                                            onclick="switchView('visitors'); setTimeout(() => $('#btn-add-visitor').click(), 100);">
                                            <i class="fas fa-user-plus me-1"></i> Register Visitor
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="card shadow-sm">
                                <div class="card-header bg-white border-bottom">
                                    <h6 class="mb-0 fw-bold text-dark">System Status</h6>
                                </div>
                                <div class="card-body p-3">
                                    <div class="d-flex justify-content-between align-items-center py-2 border-bottom">
                                        <span class="small">Notifications</span>
                                        <span class="badge bg-success">Active</span>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center py-2 border-bottom">
                                        <span class="small">Badge Printing</span>
                                        <span class="badge bg-success">Ready</span>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center py-2">
                                        <span class="small">Face Recognition</span>
                                        <span class="badge bg-success">Online</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Visitors View -->
                <div id="view-visitors" style="display: none;">
                    <div class="card shadow-sm">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0 fw-bold">Visitor Directory</h5>
                            <div class="d-flex gap-2 align-items-center">
                                <select class="form-select form-select-sm" id="filter-entity-visitors"
                                    style="width: auto; min-width: 150px;">
                                    <option value="">All Entities</option>
                                </select>
                                <button class="btn btn-primary btn-sm" id="btn-add-visitor">
                                    <i class="fas fa-plus me-2"></i>Add Visitor
                                </button>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-hover w-100 align-middle mb-0" id="visitors-table">
                                    <thead>
                                        <tr>
                                            <th style="width:60px;"></th>
                                            <th style="width:18%;">Name</th>
                                            <th style="width:22%;">Contact</th>
                                            <th style="width:20%;">Organization</th>
                                            <th style="width:12%;">Status</th>
                                            <th class="text-end" style="width:15%;">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Visits View -->
                <div id="view-visits" style="display: none;">
                    <div class="card shadow-sm">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0 fw-bold">Visit Management</h5>
                            <div class="d-flex gap-2 align-items-center">
                                <select class="form-select form-select-sm" id="filter-entity-visits"
                                    style="width: auto; min-width: 150px;">
                                    <option value="">All Entities</option>
                                </select>
                                <select class="form-select form-select-sm" id="filter-host-visits"
                                    style="width: auto; min-width: 150px;">
                                    <option value="">All Hosts</option>
                                </select>
                                <button class="btn btn-primary btn-sm" id="btn-schedule-visit">
                                    <i class="fas fa-calendar-plus me-2"></i>Schedule Visit
                                </button>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-hover w-100 align-middle mb-0" id="visits-table">
                                    <thead>
                                        <tr>
                                            <th>Visit ID</th>
                                            <th>Visitor</th>
                                            <th>Host</th>
                                            <th>Check-in</th>
                                            <th>Check-out</th>
                                            <th>Method</th>
                                            <th>Status</th>
                                            <th class="text-end">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings View -->
                <!-- Security View -->
                <div id="view-security" style="display: none;"></div>

                <!-- Reports View -->
                <div id="view-reports" style="display: none;"></div>

                <div id="view-settings" style="display: none;">
                    <div class="card shadow-sm">
                        <div class="card-header">
                            <h5 class="mb-0 fw-bold">Device & Settings</h5>
                        </div>
                        <div class="card-body">
                            <p class="text-muted">Settings and device management coming soon.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Current Visitors Modal -->
    <div class="modal fade" id="currentVisitorsModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class="fas fa-users me-2"></i>Current Visitors Inside</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                    <input type="text" class="form-control form-control-sm mb-3" id="search-current-visitors"
                        placeholder="ðŸ” Search...">
                    <div class="table-responsive">
                        <table class="table table-hover table-sm" id="current-visitors-table">
                            <thead class="table-light">
                                <tr>
                                    <th>Visitor Name</th>
                                    <th>Host</th>
                                    <th>Check-in Time</th>
                                    <th>Duration</th>
                                    <th>Phone</th>
                                    <th class="text-end">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="current-visitors-list">
                                <tr>
                                    <td colspan="6" class="text-center">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Expected Today Modal -->
    <div class="modal fade" id="expectedTodayModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background: #38b2ac; color: white;">
                    <h5 class="modal-title"><i class="fas fa-calendar-day me-2"></i>Expected Visitors Today</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                    <div class="table-responsive">
                        <table class="table table-hover table-sm">
                            <thead class="table-light">
                                <tr>
                                    <th>Visitor Name</th>
                                    <th>Host</th>
                                    <th>Expected Time</th>
                                    <th>Purpose</th>
                                </tr>
                            </thead>
                            <tbody id="expected-visitors-list">
                                <tr>
                                    <td colspan="4" class="text-center">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Checked In Modal -->
    <div class="modal fade" id="checkedInModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background: #48bb78; color: white;">
                    <h5 class="modal-title"><i class="fas fa-sign-in-alt me-2"></i>All Check-ins Today</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                    <div class="table-responsive">
                        <table class="table table-hover table-sm">
                            <thead class="table-light">
                                <tr>
                                    <th>Visitor Name</th>
                                    <th>Host</th>
                                    <th>Check-in Time</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="checked-in-list">
                                <tr>
                                    <td colspan="4" class="text-center">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Checked Out Modal -->
    <div class="modal fade" id="checkedOutModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background: #718096; color: white;">
                    <h5 class="modal-title"><i class="fas fa-sign-out-alt me-2"></i>Check-outs Today</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                    <div class="table-responsive">
                        <table class="table table-hover table-sm">
                            <thead class="table-light">
                                <tr>
                                    <th>Visitor Name</th>
                                    <th>Host</th>
                                    <th>Check-out Time</th>
                                    <th>Duration</th>
                                </tr>
                            </thead>
                            <tbody id="checked-out-list">
                                <tr>
                                    <td colspan="4" class="text-center">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- View Visitor Modal -->
    <div class="modal fade" id="viewVisitorModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content" style="max-height: 90vh; display: flex; flex-direction: column;">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">Visitor Details & Analytics</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <ul class="nav nav-tabs nav-justified" id="viewVisitorTabs">
                    <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab"
                            href="#view-visitor-details">Details</a></li>
                    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#view-visitor-history">Visit
                            History</a></li>
                    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab"
                            href="#view-visitor-analytics">Analytics</a></li>
                </ul>
                <div class="modal-body" style="flex: 1; overflow-y: auto;">
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="view-visitor-details">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="fw-bold text-muted mb-3">Visitor Images</h6>
                                    <div id="viewVisitorImageCarousel" class="carousel slide" data-bs-ride="carousel">
                                        <div class="carousel-inner">
                                            <div class="carousel-item active">
                                                <div class="visitor-image-carousel-item" id="viewVisitorImageLeft"><i
                                                        class="fas fa-user text-muted fa-3x"></i></div>
                                            </div>
                                            <div class="carousel-item">
                                                <div class="visitor-image-carousel-item" id="viewVisitorImageCenter"><i
                                                        class="fas fa-user text-muted fa-3x"></i></div>
                                            </div>
                                            <div class="carousel-item">
                                                <div class="visitor-image-carousel-item" id="viewVisitorImageRight"><i
                                                        class="fas fa-user text-muted fa-3x"></i></div>
                                            </div>
                                        </div>
                                        <button class="carousel-control-prev" type="button"
                                            data-bs-target="#viewVisitorImageCarousel" data-bs-slide="prev">
                                            <span class="carousel-control-prev-icon"></span>
                                        </button>
                                        <button class="carousel-control-next" type="button"
                                            data-bs-target="#viewVisitorImageCarousel" data-bs-slide="next">
                                            <span class="carousel-control-next-icon"></span>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="fw-bold text-muted mb-3">Personal Information</h6>
                                    <div class="row g-3">
                                        <div class="col-12"><label class="form-label small fw-bold text-muted">Full
                                                Name</label>
                                            <p id="viewVisitorName">-</p>
                                        </div>
                                        <div class="col-12"><label
                                                class="form-label small fw-bold text-muted">Email</label>
                                            <p id="viewVisitorEmail">-</p>
                                        </div>
                                        <div class="col-12"><label
                                                class="form-label small fw-bold text-muted">Phone</label>
                                            <p id="viewVisitorPhone">-</p>
                                        </div>
                                        <div class="col-12"><label
                                                class="form-label small fw-bold text-muted">Organization</label>
                                            <p id="viewVisitorOrganization">-</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="view-visitor-history">
                            <div class="table-responsive">
                                <table class="table table-sm table-hover" id="view-visitor-history-table">
                                    <thead>
                                        <tr>
                                            <th>Visit ID</th>
                                            <th>Host</th>
                                            <th>Purpose</th>
                                            <th>Check-in</th>
                                            <th>Check-out</th>
                                            <th>Method</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="view-visitor-analytics">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h6 class="card-title text-muted">Visit Statistics</h6>
                                            <div class="row text-center">
                                                <div class="col-6 mb-3">
                                                    <div class="stat-value" id="viewTotalVisits">0</div>
                                                    <div class="stat-label">Total</div>
                                                </div>
                                                <div class="col-6 mb-3">
                                                    <div class="stat-value" id="viewCompletedVisits">0</div>
                                                    <div class="stat-label">Completed</div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="stat-value" id="viewScheduledVisits">0</div>
                                                    <div class="stat-label">Scheduled</div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="stat-value" id="viewCancelledVisits">0</div>
                                                    <div class="stat-label">Cancelled</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h6 class="card-title text-muted">Recent Activity</h6>
                                            <div id="viewRecentActivity">
                                                <p class="text-muted small">No recent activity</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary"
                        data-bs-dismiss="modal">Close</button></div>
            </div>
        </div>
    </div>

    <!-- Edit Visitor Modal -->
    <div class="modal fade" id="editVisitorModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">Edit Visitor</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editVisitorForm">
                        <input type="hidden" id="editVisitorId">
                        <div class="mb-3"><label class="form-label small fw-bold">Full Name</label><input type="text"
                                class="form-control" id="editVisitorName" required></div>
                        <div class="mb-3"><label class="form-label small fw-bold">Email</label><input type="email"
                                class="form-control" id="editVisitorEmail"></div>
                        <div class="mb-3"><label class="form-label small fw-bold">Phone</label><input type="tel"
                                class="form-control" id="editVisitorPhone" required></div>
                        <div class="mb-3"><label class="form-label small fw-bold">Organization</label><input type="text"
                                class="form-control" id="editVisitorOrganization"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveEditVisitorBtn">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Visitor Modal -->
    <div class="modal fade" id="addVisitorModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">Add New Visitor</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center py-5">
                    <i class="fas fa-desktop fa-4x text-primary mb-3"></i>
                    <h5>Use Kiosk for Registration</h5>
                    <p class="text-muted">New visitors must register at the Kiosk to capture photos.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule Visit Modal -->
    <div class="modal fade" id="visitModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">Schedule Visit</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="visitForm">
                        <div class="row g-3">
                            <div class="col-md-6"><label class="form-label small fw-bold">Visitor <span
                                        class="text-danger">*</span></label><select class="form-select"
                                    id="visitVisitorId" required>
                                    <option value="">Select Visitor</option>
                                </select></div>
                            <div class="col-md-6"><label class="form-label small fw-bold">Host <span
                                        class="text-danger">*</span></label><select class="form-select" id="visitHostId"
                                    required>
                                    <option value="">Select Host</option>
                                </select></div>
                            <div class="col-md-6"><label class="form-label small fw-bold">Expected Arrival <span
                                        class="text-danger">*</span></label><input type="datetime-local"
                                    class="form-control" id="visitArrival" required></div>
                            <div class="col-md-6"><label class="form-label small fw-bold">Expected
                                    Departure</label><input type="datetime-local" class="form-control"
                                    id="visitDeparture"></div>
                            <div class="col-12"><label class="form-label small fw-bold">Purpose</label><textarea
                                    class="form-control" id="visitPurpose" rows="2"></textarea></div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveVisitBtn">Schedule Visit</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pass/Badge Modal -->
    <div class="modal fade" id="passModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">Visitor Badge</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="pass-qr-container" id="passContainer">
                        <div class="spinner-border text-primary"></div>
                    </div>
                    <div class="text-center mt-3">
                        <p class="small text-muted mb-2">Scan this at the entry point</p>
                        <button class="btn btn-primary btn-sm w-100" id="btnPrintPass"><i
                                class="fas fa-print me-2"></i>Print Badge</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>

    </table>
    </div>
    </div>
    </div>
    </div>
    </div>

    <!-- View Visitor Modal -->
    <div class="modal fade" id="viewVisitorModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content" style="max-height: 90vh; display: flex; flex-direction: column;">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">Visitor Details & Analytics</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <ul class="nav nav-tabs nav-justified" id="viewVisitorTabs">
                    <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab"
                            href="#view-visitor-details">Details</a></li>
                    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#view-visitor-history">Visit
                            History</a></li>
                    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab"
                            href="#view-visitor-analytics">Analytics</a></li>
                </ul>
                <div class="modal-body" style="flex: 1; overflow-y: auto;">
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="view-visitor-details">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="fw-bold text-muted mb-3">Visitor Images</h6>
                                    <div id="viewVisitorImageCarousel" class="carousel slide" data-bs-ride="carousel">
                                        <div class="carousel-inner">
                                            <div class="carousel-item active">
                                                <div class="visitor-image-carousel-item" id="viewVisitorImageLeft"><i
                                                        class="fas fa-user text-muted fa-3x"></i></div>
                                            </div>
                                            <div class="carousel-item">
                                                <div class="visitor-image-carousel-item" id="viewVisitorImageCenter"><i
                                                        class="fas fa-user text-muted fa-3x"></i></div>
                                            </div>
                                            <div class="carousel-item">
                                                <div class="visitor-image-carousel-item" id="viewVisitorImageRight"><i
                                                        class="fas fa-user text-muted fa-3x"></i></div>
                                            </div>
                                        </div>
                                        <button class="carousel-control-prev" type="button"
                                            data-bs-target="#viewVisitorImageCarousel" data-bs-slide="prev">
                                            <span class="carousel-control-prev-icon"></span>
                                        </button>
                                        <button class="carousel-control-next" type="button"
                                            data-bs-target="#viewVisitorImageCarousel" data-bs-slide="next">
                                            <span class="carousel-control-next-icon"></span>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="fw-bold text-muted mb-3">Personal Information</h6>
                                    <div class="row g-3">
                                        <div class="col-12"><label class="form-label small fw-bold text-muted">Full
                                                Name</label>
                                            <p id="viewVisitorName">-</p>
                                        </div>
                                        <div class="col-12"><label
                                                class="form-label small fw-bold text-muted">Email</label>
                                            <p id="viewVisitorEmail">-</p>
                                        </div>
                                        <div class="col-12"><label
                                                class="form-label small fw-bold text-muted">Phone</label>
                                            <p id="viewVisitorPhone">-</p>
                                        </div>
                                        <div class="col-12"><label
                                                class="form-label small fw-bold text-muted">Organization</label>
                                            <p id="viewVisitorOrganization">-</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="view-visitor-history">
                            <div class="table-responsive">
                                <table class="table table-sm table-hover" id="view-visitor-history-table">
                                    <thead>
                                        <tr>
                                            <th>Visit ID</th>
                                            <th>Host</th>
                                            <th>Purpose</th>
                                            <th>Check-in</th>
                                            <th>Check-out</th>
                                            <th>Method</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="view-visitor-analytics">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h6 class="card-title text-muted">Visit Statistics</h6>
                                            <div class="row text-center">
                                                <div class="col-6 mb-3">
                                                    <div class="stat-value" id="viewTotalVisits">0</div>
                                                    <div class="stat-label">Total</div>
                                                </div>
                                                <div class="col-6 mb-3">
                                                    <div class="stat-value" id="viewCompletedVisits">0</div>
                                                    <div class="stat-label">Completed</div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="stat-value" id="viewScheduledVisits">0</div>
                                                    <div class="stat-label">Scheduled</div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="stat-value" id="viewCancelledVisits">0</div>
                                                    <div class="stat-label">Cancelled</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h6 class="card-title text-muted">Recent Activity</h6>
                                            <div id="viewRecentActivity">
                                                <p class="text-muted small">No recent activity</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary"
                        data-bs-dismiss="modal">Close</button></div>
            </div>
        </div>
    </div>



    <!-- Pass/Badge Modal -->
    <div class="modal fade" id="passModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold">Visitor Badge</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="pass-qr-container" id="passContainer">
                        <div class="spinner-border text-primary"></div>
                    </div>
                    <div class="text-center mt-3">
                        <p class="small text-muted mb-2">Scan this at the entry point</p>
                        <button class="btn btn-primary btn-sm w-100" id="btnPrintPass"><i
                                class="fas fa-print me-2"></i>Print Badge</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>

    <!-- VMS Modules -->
    <script src="/js/apps/vms/utils.js"></script>
    <script src="/js/apps/vms/api.js"></script>
    <script src="/js/apps/vms/dashboard.js"></script>
    <script src="/js/apps/vms/visitors.js"></script>
    <script src="/js/apps/vms/visits.js"></script>
    <script src="/js/apps/vms/settings.js"></script>
    <script src="/js/apps/vms/component-loader.js"></script>
    <script src="/js/apps/vms/main.js"></script>
</body>

</html>